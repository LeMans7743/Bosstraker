<!DOCTYPE html><html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>BOSS重生時間追蹤器</title>
<script src="https://cdn.tailwindcss.com"></script>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
<style>
body { font-family: 'Inter', sans-serif; }
.boss-btn.selected { background-color: #4f46e5; color: white; }
.flash-blue { animation: flashBlue 1s infinite; }
.flash-red { animation: flashRed 1s infinite; }
@keyframes flashBlue { 0%,100%{background-color:#3b82f6;}50%{background-color:#60a5fa;} }
@keyframes flashRed { 0%,100%{background-color:#ef4444;}50%{background-color:#f87171;} }
</style>
</head>
<body class="bg-gray-100 flex flex-col items-center justify-start min-h-screen p-4">
<div class="bg-white shadow-xl rounded-2xl w-full max-w-5xl p-4 flex flex-col items-center space-y-4"><div class="w-full">
<h2 class="text-xl font-semibold text-gray-700 mb-2">追蹤列表</h2>
<div id="boss-list" class="flex flex-col gap-1"></div>
</div><div class="w-full bg-gray-50 p-4 rounded-xl shadow-inner">
<h2 class="text-xl font-semibold text-gray-700 mb-2">新增追蹤項目</h2>
<form id="add-boss-form" class="space-y-2">
<div class="space-y-1">
<label class="block text-sm font-medium text-gray-700">BOSS名稱</label>
<div id="boss-buttons" class="grid grid-cols-2 md:grid-cols-3 gap-2">
<button type="button" data-boss-name="雪毛怪人" class="boss-btn p-2 border border-gray-300 rounded-md text-sm">雪毛怪人</button>
<button type="button" data-boss-name="咕咕鐘" class="boss-btn p-2 border border-gray-300 rounded-md text-sm">咕咕鐘</button>
<button type="button" data-boss-name="測試王" class="boss-btn p-2 border border-gray-300 rounded-md text-sm">測試王</button>
</div>
<input type="hidden" id="boss-name" required>
</div>
<div class="flex space-x-2">
<div class="flex-1">
<label for="boss-channel" class="block text-sm font-medium text-gray-700">頻道</label>
<input type="number" id="boss-channel" required class="mt-1 block w-full px-2 py-1 border border-gray-300 rounded-md text-sm">
</div>
<div class="flex-1 flex items-end">
<button type="button" id="lock-boss" class="px-2 py-1 bg-yellow-400 text-white rounded">鎖定 BOSS</button>
</div>
</div>
<button type="submit" class="w-full py-1 px-4 rounded-md bg-indigo-600 text-white hover:bg-indigo-700">新增項目</button>
</form>
</div></div>
<script>
const bossButtons = document.querySelectorAll('.boss-btn');
const bossInput = document.getElementById('boss-name');
const bossList = document.getElementById('boss-list');
const lockBtn = document.getElementById('lock-boss');
const BOSS_TIMES = { '雪毛怪人': [45,68], '咕咕鐘':[68,90], '測試王':[0.083,0.167] }; // 分鐘
let selectedBoss = null;
let lockedBoss = null;bossButtons.forEach(btn => { btn.addEventListener('click', () => { if(!lockedBoss){ if(selectedBoss) bossButtons.forEach(b=>b.classList.remove('selected')); btn.classList.add('selected'); bossInput.value = btn.dataset.bossName; selectedBoss = btn.dataset.bossName; } }); });

lockBtn.addEventListener('click', ()=>{ lockedBoss = selectedBoss; alert('已鎖定 BOSS: ' + (lockedBoss || '無')); });

document.getElementById('add-boss-form').addEventListener('submit', e=>{ e.preventDefault(); const bossName = bossInput.value; const channel = document.getElementById('boss-channel').value; if(!bossName || !channel){alert('請選擇BOSS並填寫頻道');return;}

const [minTime,maxTime] = BOSS_TIMES[bossName];
const now = new Date();
let minRespawn = new Date(now.getTime()+minTime*60*1000);
let maxRespawn = new Date(now.getTime()+maxTime*60*1000);

const bossItem = document.createElement('div');
bossItem.className='bg-green-500 rounded-xl shadow-lg p-2 flex justify-between items-center';

bossItem.innerHTML=`

<p class="font-bold">${bossName}</p>
<p class="text-sm text-gray-50">頻道: ${channel}</p>
<p class="text-sm text-gray-50">倒數計時: <span class="countdown"></span></p>
<div class="flex gap-1">
<button class="kill-btn px-2 py-0.5 text-xs bg-yellow-400 text-white rounded">已擊殺</button>
<button class="delete-btn px-2 py-0.5 text-xs bg-red-500 text-white rounded">刪除</button>
</div>`;bossList.prepend(bossItem);

const countdownEl = bossItem.querySelector('.countdown');
let killed = false;

function updateCountdown(){
    const now = new Date();
    let diff = (minRespawn-now)/1000;
    if(diff>0){
        bossItem.style.backgroundColor='#22c55e';
    } else {
        diff = (maxRespawn-now)/1000;
        if(diff>60){
            countdownEl.textContent='重生中';
            bossItem.style.backgroundColor='#22c55e';
            notify(`${bossName} 在頻道 ${channel} 即將重生`);
        } else if(diff>0){
            countdownEl.textContent='即將重生完畢';
            bossItem.style.backgroundColor='#f97316';
            notify(`${bossName} 在頻道 ${channel} 即將重生完畢`);
        } else {
            countdownEl.textContent='已脫離掌握';
            bossItem.style.backgroundColor='#ef4444';
            clearInterval(interval);
        }
    }
    if(diff>0){
        const m = Math.floor(diff/60);
        const s = Math.floor(diff%60);
        countdownEl.textContent=`${m}分${s}秒`;
    }
}

const interval = setInterval(updateCountdown,1000);

bossItem.querySelector('.delete-btn').addEventListener('click',()=>{clearInterval(interval); bossItem.remove();});
bossItem.querySelector('.kill-btn').addEventListener('click',()=>{
    minRespawn = new Date();
    maxRespawn = new Date();
    killed = true;
});

bossInput.value='';
document.getElementById('boss-channel').value='';

});

function notify(msg){ if(Notification.permission==='granted'){ navigator.serviceWorker.getRegistration().then(reg=>{ reg.showNotification('BOSS提醒', {body: msg, icon:''}); }); } }

if(Notification.permission!=='granted') Notification.requestPermission(); </script>

</body>
</html>